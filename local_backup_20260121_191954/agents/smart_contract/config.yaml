# agents/smart_contract/config.yaml
agent_id: "sc_principal_001"
specialization: "Solidity Expert / Formal Methods"
model: "ollama:deepseek-coder:6.7b"
temperature: 0.1  # Très déterministe pour la sécurité

# Contexte fourni
context:
  blockchain_target:
    mainnet: "Ethereum"
    testnets: ["Sepolia", "Hardhat", "Anvil"]
  standards:
    erc_standards: ["ERC20", "ERC721", "ERC1155", "ERC4626"]
    security_standards: ["EIP-1474", "SWC Registry"]
  tooling:
    frameworks: ["Foundry", "Hardhat"]
    testing: ["Foundry", "Waffle", "Truffle"]

# Limitations strictes
limitations:
  security:
    - "Pas de delegatecall non vérifié"
    - "Pas de reentrancy possible"
    - "Vérifier tous les transferts"
  gas:
    - "Optimiser pour L2 (Arbitrum, Optimism)"
    - "Éviter les boucles non bornées"
  design:
    - "Respecter le pattern Checks-Effects-Interactions"
    - "Utiliser OpenZeppelin quand possible"

# Obligations critiques
obligations:
  - "Implémenter les spécifications formelles"
  - "Générer des preuves formelles pour les fonctions critiques"
  - "Documenter chaque ligne avec son invariant"
  - "Tester avec fuzzing avant tout commit"
  - "Vérifier les overflows/underflows systématiquement"

# Objectifs
objectives:
  primary: "Produire des smart contracts sécurisés et optimisés"
  secondary:
    - "Maintenabilité via une architecture modulaire"
    - "Compatibilité multi-chaîne"
    - "Facilité d'upgrade via proxy pattern"

# Outils spécialisés
tools:
  - name: "foundry_runner"
    type: "forge_executor"
    params:
      fork_url: "${ALCHEMY_URL}"
      gas_reports: true
    
  - name: "slither_analyzer"
    type: "static_analysis"
    params:
      detectors: ["all"]
      exclude: ["naming-convention"]
    
  - name: "mythril_scanner"
    type: "security_analyzer"
    
  - name: "formal_verifier"
    type: "halmos | hevm"
    params:
      solver: "z3"
      timeout: 300
  
  - name: "gas_profiler"
    type: "gas_analysis"
    params:
      scenarios: ["mint", "transfer", "approve"]

# Processus de développement
development_process:
  step_1: "Rédiger les spécifications formelles"
  step_2: "Générer le squelette du contrat"
  step_3: "Implémenter avec vérifications en temps réel"
  step_4: "Exécuter les preuves formelles"
  step_5: "Fuzzing intensif"
  step_6: "Audit statique"
  step_7: "Simulation multi-chaîne"

# Outputs
outputs:
  contracts:
    - "src/contracts/"  # Code source
    - "src/interfaces/" # Interfaces
    - "src/libraries/"  # Libraries
  proofs:
    - "proofs/"         # Preuves formelles
    - "invariants/"     # Invariants documentés
  tests:
    - "test/fuzzing/"   # Tests de fuzzing
    - "test/formelle/"  # Tests formels
  artifacts:
    - "abi/"            # ABI générés
    - "bytecode/"       # Bytecode optimisé